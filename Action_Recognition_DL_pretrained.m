function [] = Action_Recognition_DL_pretrained()

    %% laod train and test datasets
    trainset_path = fullfile("data/", "Dataset", "TrainSet");
    train_ds = imageDatastore(trainset_path, 'IncludeSubfolders',true, 'LabelSource','foldernames');
    
    testset_path = fullfile("data/", "Dataset", "TestSet");
    test_ds = imageDatastore(testset_path, 'IncludeSubfolders',true, 'LabelSource','foldernames');
    
    %% visualize sample images
    visualize_imgs(train_ds, test_ds);
    
    %% split training into train and validaation sets
    [train_ds,valid_ds] = splitEachLabel(train_ds,0.7);
    
    
    %% googlenet, 10 layers frozen
    googlenet_10f = googlenet('Weights','imagenet');
    
    hyperparams = {
        {15, 10, 3e-4, 'none', 0, 1, 'sgdm', 10}, ...
        {15, 10, 0.001, 'none', 0, 1, 'sgdm', 10}, ...
        {15, 10, 3e-4, 'none', 0, 1, 'adam', 10}, ...
        {15, 10, 0.001, 'none', 0, 1, 'adam', 10}, ...
        {15, 10, 3e-4, 'piecewise', 0.5, 5, 'sgdm', 10}, ...
        {15, 10, 0.001, 'piecewise', 0.5, 5, 'adam', 10}, ...
        };
    
    [googlenet_10f_best_valid_acc, googlenet_10f_best_test_acc, googlenet_10f_best_hyper_params] = part2_tune_hyperparams(googlenet_10f, hyperparams, train_ds, valid_ds, test_ds);
    
    %% resnet50, 100 frozen layers
    resnet50_100f = resnet50('Weights','imagenet');
    
    hyperparams = {
        {15, 100, 3e-4, 'none', 0, 1, 'sgdm', 10}, ...
        {15, 100, 0.001, 'none', 0, 1, 'sgdm', 10}, ...
        {15, 100, 3e-4, 'none', 0, 1, 'adam', 10}, ...
        {15, 100, 0.001, 'none', 0, 1, 'adam', 10}, ...
        {15, 100, 3e-4, 'piecewise', 0.5, 5, 'sgdm', 10}, ...
        {15, 100, 0.001, 'piecewise', 0.5, 5, 'adam', 10}, ...
        };
    
    [resnet50_100f_best_valid_acc, resnet50_100f_best_test_acc, resnet50_100f_best_hyper_params] = part2_tune_hyperparams(resnet50_100f, hyperparams, train_ds, valid_ds, test_ds);
    
    
    
    %% resnet50, 150 frozen layers
    resnet50_150f = resnet50('Weights','imagenet');
    
    hyperparams = {
        {15, 150, 3e-4, 'none', 0, 1, 'sgdm', 10}, ...
        {15, 150, 0.001, 'none', 0, 1, 'sgdm', 10}, ...
        {15, 150, 3e-4, 'none', 0, 1, 'adam', 10}, ...
        {15, 150, 0.001, 'none', 0, 1, 'adam', 10}, ...
        {15, 150 3e-4, 'piecewise', 0.5, 5, 'sgdm', 10}, ...
        {15, 150, 0.001, 'piecewise', 0.5, 5, 'adam', 10}, ...
        };
    
    [resnet50_150f_best_valid_acc, resnet50_150f_best_test_acc, resnet50_150f_best_hyper_params] = part2_tune_hyperparams(resnet50_150f, hyperparams, train_ds, valid_ds, test_ds);
    
    
    %% resnet50, 174 frozen layers
    resnet50_174f = resnet50('Weights','imagenet');
    
    hyperparams = {
        {15, 174, 3e-4, 'none', 0, 1, 'sgdm', 10}, ...
        {15, 174, 0.001, 'none', 0, 1, 'sgdm', 10}, ...
        {15, 174, 3e-4, 'none', 0, 1, 'adam', 10}, ...
        {15, 174, 0.001, 'none', 0, 1, 'adam', 10}, ...
        {15, 174 3e-4, 'piecewise', 0.5, 5, 'sgdm', 10}, ...
        {15, 174, 0.001, 'piecewise', 0.5, 5, 'adam', 10}, ...
        };
    
    [resnet50_174f_best_valid_acc, resnet50_174f_best_test_acc, resnet50_174f_best_hyper_params] = part2_tune_hyperparams(resnet50_174f, hyperparams, train_ds, valid_ds, test_ds);
    
    
    
    %% resnet101, 250 frozen weights
    resnetnet101_250f = resnet101('Weights','imagenet');
    
    hyperparams = {
        {15, 250, 3e-4, 'none', 0, 1, 'sgdm', 10}, ...
        {15, 250, 0.001, 'none', 0, 1, 'sgdm', 10}, ...
        {15, 250, 3e-4, 'none', 0, 1, 'adam', 10}, ...
        {15, 250, 0.001, 'none', 0, 1, 'adam', 10}, ...
        {15, 250, 3e-4, 'piecewise', 0.5, 5, 'sgdm', 10}, ...
        {15, 250, 0.001, 'piecewise', 0.5, 5, 'adam', 10}, ...
        };
    
    [resnetnet101_250f_best_valid_acc, resnetnet101_250f_best_test_acc, resnetnet101_250f_best_hyper_params] = part2_tune_hyperparams(resnetnet101_250f, hyperparams, train_ds, valid_ds, test_ds);
    
    
    %% resnet101, 344 frozen weights
    resnetnet101_344f = resnet101('Weights','imagenet');
    
    hyperparams = {
        {15, 344, 3e-4, 'none', 0, 1, 'sgdm', 10}, ...
        {15, 344, 0.001, 'none', 0, 1, 'sgdm', 10}, ...
        {15, 344, 3e-4, 'none', 0, 1, 'adam', 10}, ...
        {15, 250, 0.001, 'none', 0, 1, 'adam', 10}, ...
        {15, 250, 3e-4, 'piecewise', 0.5, 5, 'sgdm', 10}, ...
        {15, 250, 0.001, 'piecewise', 0.5, 5, 'adam', 10}, ...
        };
    
    [resnetnet101_344f_best_valid_acc, resnetnet101_344f_best_test_acc, resnetnet101_344f_best_hyper_params] = part2_tune_hyperparams(resnetnet101_344f, hyperparams, train_ds, valid_ds, test_ds);

end